# CSV到JSON转换工具 - GUI版本使用说明

## 问题修复总结

### 已修复的问题

1. **导入Excel文件报错问题**
   - 修复了PyQt信号连接的语法错误
   - 修正了`on_item_changed`方法的参数问题
   - 现在可以正常导入Excel文件（.xlsx, .xls格式）

2. **不支持CSV文件问题**
   - 增强了CSV文件读取功能
   - 支持多种编码格式：utf-8, gbk, gb2312, utf-8-sig
   - 自动尝试不同编码以提高兼容性

## 支持的文件格式

- **Excel文件**: .xlsx, .xls
- **CSV文件**: .csv（支持多种编码）

## 启动方法

```bash
python run_gui.py
```

## 使用步骤

### 1. 启动应用程序
运行上述命令后，会看到GUI界面启动。

### 2. 导入文件
- 点击"导入文件"按钮
- 选择CSV或Excel文件
- 系统会自动检测文件格式并加载数据

### 3. 数据预览和编辑
- 在数据表格中查看导入的数据
- 可以直接编辑表格中的数据
- 支持下拉框选择（根据配置文件设置）

### 4. 配置映射
- 在"配置"标签页中设置字段映射
- 配置传感器和通信参数
- 点击"保存配置"保存设置

### 5. 预览JSON
- 在"JSON预览"标签页查看转换结果
- 点击"刷新预览"更新JSON内容

### 6. 导出结果
- 点击"导出JSON"按钮
- 选择保存位置
- 生成最终的JSON文件

## 测试文件

项目中包含以下测试文件：
- `test_data.csv` - 测试CSV文件
- `demo_data.xlsx` - 演示Excel文件

可以使用这些文件来测试GUI功能。

## 智能特性

1. **自动编码检测**: 自动尝试多种编码读取CSV文件
2. **实时预览**: 数据修改后实时更新JSON预览
3. **智能约束**: 根据配置文件自动设置字段约束
4. **错误处理**: 友好的错误提示和处理

## 配置文件

- `config/mapping_config.json` - 字段映射配置
- `config/sensor_config.json` - 传感器配置
- `config/communication_config.json` - 通信配置

## 故障排除

### 如果遇到导入问题：
1. 确保文件格式正确（CSV或Excel）
2. 检查文件编码（CSV文件建议使用UTF-8）
3. 确保文件没有被其他程序占用

### 如果GUI无法启动：
1. 检查Python环境
2. 确保所有依赖已安装：
   ```bash
   pip install -r requirements.txt
   ```
3. 运行测试脚本验证：
   ```bash
   python test_gui_fixed.py
   ```

## 技术支持

如果遇到其他问题，请检查：
1. Python版本（建议3.7+）
2. PyQt5版本（5.15.x）
3. pandas和openpyxl库是否正确安装

---

**注意**: 此GUI工具完全兼容原有的命令行版本，所有配置文件和转换逻辑保持一致。